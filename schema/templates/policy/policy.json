{
  "$id": "https://raw.githubusercontent.com/openmobilityfoundation/mobility-data-specification/main/policy/policy.json",
  "$schema": "http://json-schema.org/draft-06/schema#",
  "title": "The MDS Policy Schema",
  "type": "object",
  "definitions": {
    "policy": {
      "$id": "#/definitions/policy",
      "type": "object",
      "title": "The policy object schema",
      "additionalItems": false,
      "required": [
        "name",
        "policy_id",
        "description",
        "start_date",
        "published_date",
        "rules"
      ],
      "properties": {
        "name": {
          "$id": "#/definitions/policy/properties/name",
          "$ref": "#/definitions/string",
          "description": "Name of policy"
        },
        "policy_id": {
          "$id": "#/definitions/policy/properties/policy_id",
          "$ref": "#/definitions/uuid",
          "description": "Unique ID of policy"
        },
        "description": {
          "$id": "#/definitions/policy/properties/description",
          "$ref": "#/definitions/string",
          "description": "Description of policy"
        },
        "start_date":{
          "$id": "#/definitions/policy/properties/start_date",
          "$ref": "#/definitions/timestamp",
          "description": "Beginning date/time of policy enforcement"
        },
        "published_date": {
          "$id": "#/definitions/policy/properties/published_date",
          "$ref": "#/definitions/timestamp",
          "description": "Timestamp at which the policy was published"
        },
        "rules": {
          "$id": "#/definitions/rule",
          "type": "array",
          "description": "List of applicable Rule objects",
          "items": {
            "$id": "#/definitions/policy/properties/rules/items",
            "$ref": "#/definitions/rule"
          },
          "minItems": 1
        }
      }
    },
    "rule": {
      "$id": "#/definitions/rule",
      "type": "object",
      "description": "An individual rule in a policy",
      "additionalProperties": false,
      "required": [
        "name",
        "rule_id",
        "rule_type",
        "geographies",
        "states",
        "rule_units"
      ],
      "properties": {
        "name": {
          "$id": "#/definitions/rule/properties/name",
          "$ref": "#/definitions/string",
          "description": "Name of rule"
        },
        "rule_id": {
          "$id": "#/definitions/rule/properties/rule_id",
          "$ref": "#/definitions/uuid",
          "description": "Unique ID of rule"
        },
        "rule_type": {
          "$id": "#/definitions/rule/properties/rule_type",
          "type": "string",
          "description": "The type of rule",
          "enum": [
            "count",
            "time",
            "speed",
            "rate",
            "user"
          ]
        },
        "geographies": {
          "$id": "#/definitions/rule/properties/geographies",
          "type": "array",
          "description": "List of Geography UUIDs (non-overlapping) specifying the covered geography",
          "items": {
            "$id": "#/definitions/rule/properties/geographies/items",
            "$ref": "#/definitions/uuid"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "states": {
          "$id": "#/definitions/rule/properties/states",
          "type": "object"
        },
        "rule_units": {
          "$id": "#/definitions/rule/properties/rule_units",
          "type": "string",
          "description": "Meaured units of policy",
          "enum": [
            "seconds",
            "minutes",
            "hours",
            "days",
            "mph",
            "kph",
            "devices",
            "amount"
          ]
        }
      }
    }
  },
  "required": [
    "data",
    "updated",
    "version"
  ],
  "properties": {
    "data": {
      "$id": "#/properties/data",
      "type": "object",
      "description": "The data records in this payload",
      "required": [
        "policy"
      ],
      "properties": {
        "policy": {
          "$id": "#/properties/data/properties/policy",
          "type": "array",
          "title": "The policy payload",
          "items": {
            "$id": "#/properties/data/properties/policy/items",
            "$ref": "#/definitions/policy"
          }
        }
      },
      "additionalProperties": false
    },
    "end_date": {
      "$id": "#/properties/end_date",
      "$ref": "#/definitions/timestamp",
      "description": "The timestamp after which the Policy is no longer effective"
    },
    "updated": {
      "$id": "#/properties/updated",
      "$ref": "#/definitions/timestamp",
      "description": "The timestamp when the Policy document was last updated"
    },
    "version": {
      "$id": "#/properties/version",
      "$ref": "#/definitions/version",
      "description": "The MDS version this Policy document corresponds with"
    }
  },
  "additionalProperties": false
}